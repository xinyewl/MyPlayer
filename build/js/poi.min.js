function lcz(){var _this=this;this.geci_object,this.geci_lines,this.upkp,this.classV1,this.classV2,this.initTop,this.center,this.empty,this.isDropgeci,this.width,this.height,this.align,this.oneline,this.luminous,this.change,this.staue=!0,this.tag={},this.mould='<ul style="height: 300px;list-style: none;position: relative;line-height: 28px;padding: 0 15px;overflow-y: hidden;display:none;"></ul>',this.getgeci="Value";var errmsg="程序发生异常，无法继续了！";this.toTimer=function(e){var t,n;return t=Math.floor(e/60),t=isNaN(t)?"--":t>=10?t:"0"+t,n=Math.floor(e%60),n=isNaN(n)?"--":n>=10?n:"0"+n,t+":"+n},this.addgeci=function(e,t,n){var r=document.createElement("li");r.innerHTML=t?t:"",r.className=e?e:"",r.lang=n?n:"",this.geci_object.appendChild(r),this.geci_lines.push(r)},this.getgeciByValue=function(e){le=this.geci_lines.length,e="^"+e+".*";for(var t=0;t<le;t++){if(this.geci_lines[t].lang.search(e)==0){return this.geci_lines[t]}}return null},this.getgeciByValueInd=function(e){le=this.geci_lines.length-1;for(var t=le;t>=0;t--){p=this.geci_lines[t].lang;if(p&&p<e){return this.geci_lines[t]}}return null},this.setClassName=function(e,t){e&&(e.className=t)},this.upTop=function(e){var t=e.offsetTop,n=this.geci_object.scrollTop,r=t-this.center;this.myf(this.geci_object,n,r)},this.remove=function(){if(this.geci_lines!=null){for(var e=0;e<this.geci_lines.length;e++){this.geci_object.removeChild(this.geci_lines[e])}}this.geci_lines=new Array,!this.empty&&this.empty!=0&&alert("empty 属性有误! 该值必须>=零")},this.load=function(json,fun){gecis=json.gecis,end=json[this.tag.end];with(this){remove(),_addgeci(json[this.tag.sname]),_addgeci(json[this.tag.cname]),_addgeci(json[this.tag.qname]),_addgeci(json[this.tag.bname]),_addgeci(json[this.tag.sgname]),_addgeci(json[this.tag.special]),_addgeci(json[this.tag.kname])}if(gecis){for(var index in gecis){this.addgeci(this.classV1,gecis[index].name,gecis[index].time)}}end&&(end.time?this.addgeci(this.classV1,end.end,end.time):this.addgeci(this.classV1,end)),typeof fun=="function"&&fun.call(null,null)},this._addgeci=function(e){e&&(e.time?this.addgeci(this.classV1,e.name,e.time):this.addgeci(this.classV1,e))},this.Read=function(e,t){if(t!=null&&typeof t=="function"){return t.call(this,e)}var n={};n.gecis=new Array;var r=e.split("["),i=r.length;for(var s=0;s<i;s++){var o=r[s],u=o.split("]");if(u.length==2){if(u[0].search("^[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0){title=u[0].split(":"),n=tagswitch(title,n)}else{var a={time:u[0],name:u[1]};n.gecis.push(a)}}}return n},this.vls1=function(e){var n={};n.gecis=new Array;var r=e.length,i=0,s=0,o=new Array;for(var u=0;u<r;u++){e[u]=="["&&u>8&&(e.slice(u-9,u-1)+"").search("^[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0&&(o.push(e.substring(i,u)),i=u)}o.push(e.substring(i,r));var a={},f=[];for(var u=0;u<o.length;u++){var l=o[u],c=l.split("]");if(c.length===2){(c[0]+"").search("^\\[[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0?(c[0]=c[0].slice(1),title=c[0].split(":"),n=tagswitch(title,n)):(h=c[0].slice(1)+"",a[h]=c[1],f.push(h))}else{if(c.length>2){var h,e;e=c[c.length-1];for(var p in c){c[p].search("^\\[[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")==0&&(h=c[p].slice(1)+"",a[h]=e,f.push(h))}}}}f=f.sort();for(var p in f){t=f[p];var d={time:t,name:a[t]};n.gecis.push(d)}return n};var tagswitch=function(e,t){e.length===2&&(tp=e[1]),tag=_this.tag;switch(e[0]){case tag.sname:t[tag.sname]=tp;break;case tag.cname:t[tag.cname]=tp;break;case tag.qname:t[tag.qname]=tp;break;case tag.bname:t[tag.bname]=tp;break;case tag.sgname:t[tag.sgname]=tp;break;case tag.special:t[tag.special]=tp;break;case tag.kname:t[tag.kname]=tp;break;case tag.end:t[tag.end]=tp}return t};this.myf_Init=function(){this.geci_object.innerHTML=this.mould,asc=this.geci_object=this.geci_object.firstChild,asc.style.width=this.width,asc.style.height=this.height,asc.style.textAlign=this.align,this.oneline?(this.empty=0,this.center=5):(this.empty=5,this.center=this.geci_object.style.height/2|80),this.isDropgeci&&this.logon(!1)},this.setoccupy=function(e,t){e.style.display="block",this.setClassName(e,this.classV2),this.upTop(e),this.upkp&&this.unoccupy(this.upkp),this.upkp=e,t&&t(e)},this.unoccupy=function(e,t){this.setClassName(e,this.classV1),this.oneline&&(e.style.display="none"),t&&t(e)},this.torun=function(time){if(!this.staue){return !1}var time=this.toTimer(Math.round((time|event.srcElement.currentTime)*100)/100),line=eval("this.getgeciBy"+this.getgeci+"(time)");line&&this.upkp!=line&&this.setoccupy(line)},this.logon=function(e){if(window.FileReader){var t=this.geci_object;e&&(t=document.getElementById(e));function n(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;for(var n=0,r;r=t[n];n++){var i=new FileReader;i.onloadend=function(e){return function(e){img=e.target.result,img&&_this.load(_this.Read(img))}}(r),i.readAsText(r)}}function r(e){}function i(e){}function s(e){e.stopPropagation(),e.preventDefault()}t.addEventListener("dragenter",r,!1),t.addEventListener("dragover",s,!1),t.addEventListener("drop",n,!1),t.addEventListener("dragleave",i,!1),t.addEventListener("ondragend",i,!1)}else{alert("你的浏览器不支持啊，同学")}};var timer=null;this.myf=function(e,t,n){timer!=null&&clearTimeout(timer),this.isUpOrDown(e,t,n)},getUpValue=function(e,t){return t-e>100?e+=30:t-e>50?e+=10:t-e>20?e+=5:t-e>1&&e++,e},getDowmValue=function(e,t){return e-t>100?e-=30:e-t>50?e-=10:e-t>20?e-=5:e-t>1&&e--,e},this.isUpOrDown=function(e,t,n){t<n?this.toUp(e,t,n):this.toDown(e,t,n)},this.toUp=function(e,t,n){timer=setInterval(function(){t>=n&&(clearTimeout(timer),timer=null,e.scrollTop=n),e.scrollTop=t,t=getUpValue(t,n)},10)},this.toDown=function(e,t,n){timer=setInterval(function(){t<=n&&(clearTimeout(timer),timer=null,e.scrollTop=n),e.scrollTop=t,t=getDowmValue(t,n)},30)},this.destory=function(){}}geci={msg:{ms1:"元素位置没有给出！ error : 103",ms2:"请给出歌词的链接地址，或文本内容！ error : 105"},tag:{sname:"ti",cname:"cl",qname:"cs",bname:"ps",sgname:"ar",special:"al",kname:"by",end:"end"},build:function(e,d){var f=new lcz;return f.tag=geci.tag,e.object?f.geci_object=document.getElementById(e.object):alert(geci.msg.ms1),f.initTop=e.initTop!=null?e.initTop:0,f.center=e.center!=null?e.center:0,f.empty=e.empty!=null?e.empty:0,f.isDropgeci=e.isDropgeci!=null?e.isDropgeci:!0,f.getgeci=e.seekMark!=null?e.seekMark:"Value",d&&(f.classV1=d.notoccupy!=null?d.notoccupy:"geci_moonlight",f.classV2=d.occupy!=null?d.occupy:"geci_attention",f.width=d.width!=null?d.width:"550px",f.height=d.height!=null?d.height:"200px",f.align=d.align!=null?d.align:"center",f.oneline=d.oneline!=null?d.oneline:!1),f.myf_Init(),geci.readgeci(f,e.readType,{url:e.geciUrl?e.geciUrl:null,text:e.geciText?e.geciText:null},function(){f.geci_object.scrollTop=f.initTop,f.oneline&&(f.geci_object.className+=" geci_hide"),e.syntony&&e.syntony(f)})&&e.open&&geci.open(f),e.media&&(mp=document.getElementById(e.media),window.attachEvent?mp.attachEvent("ontimeupdate",function(){f.torun()}):mp.addEventListener("timeupdate",function(){f.torun()},!1)),f},readgeci:function(i,g,j,h){var e="";if(j.text){e=j.text}else{if(!j.url){return alert(geci.msg.ms2),!1}xmlhttp=null,window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:window.ActiveXObject&&(xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")),xmlhttp!=null&&(xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){return e=xmlhttp.responseText,e=e.replace(/<\/?.+?>/g,"").replace(/[\r\n]/g,""),i.load(i.Read(e,g),h),!0}$("#lrc_2 ul").append('<li style="color: #69d2e7;">暂无歌词</li>')}},xmlhttp.open("GET",j.url,!0),xmlhttp.send(null))}return i.load(i.Read(e,g),h),!0},open:function(b){b.geci_object&&(b.geci_object.style.display="block"),b.staue=!0},close:function(b){b.geci_object&&(b.geci_object.style.display="none"),b.staue=!1},suspend:function(b){b.geci_object&&(b.staue=!1)},destroy:function(b){geci.close(b),b.remove(b.geci_object)},setProgress:function(d,c){d.torun(c)}};(function(a){if(a(".music-search-json").length>0){for(var l=0;l<playlist.length;l++){var o=playlist[l],n=o.list,g=l;g++;a("#poi-search-music-list").append('<div id="list-music-song"><div class="try-listen"><a href="javascript:;" id="try-listen-play"><i class="poifont goplay">&#xe60c;</i></a></div><div class="list-song-cover"><div class="list-music-cover"><span class="song-cd-cover" style="background-image:url('+n.cover+');"></span><span class="song-cd-pan" style="background-image:url('+n.cd+');"></span></div></div><ul class="list-song-info"><li class="list-song-info-title"><i class="poifont">&#xe600;</i> '+n.title+" - "+n.artist+'</li><li class="list-song-info-link"><i class="poifont">&#xe601;</i> '+n.mp3+'</li><li class="list-song-info-down"><i class="poifont">&#xe601;</i> '+n.download+'</li><li class="list-song-info-mv"><i class="poifont">&#xe603;</i> MV功能正在施工...</li></ul></div>');a("#poi-playlist ul").append("<li>"+g+".&nbsp;&nbsp;"+n.artist+" - "+n.title+"</li>")}a("#try-listen-play i").each(function(c){a(this).on("click",function(){C(c);if(a(this).hasClass("goplay")){u();a("#try-listen-play i").html("&#xe60c;").eq(c).html("&#xe611;");a(this).html("&#xe611;").removeClass("goplay")}else{s();a(this).html("&#xe60c;").addClass("goplay")}})})}else{for(var l=0;l<playlist.length;l++){var o=playlist[l],n=o.list,g=l;g++;a("#poi-playlist ul").append("<li>"+g+".&nbsp;&nbsp;"+n.artist+" - "+n.title+"</li>")}var r=function(){var c=(boxsearch)?true:false;if(c){if(a("#poi-play-bar").hasClass("poi-c")){a("#poi-play-bar").removeClass("poi-c").addClass("poi-o").css({width:"100%"});a("#open-poi-player i").html("&#xe607;")}if(a("#poi-music-list").hasClass("poi-music-list-c")){a("#poi-music-list").removeClass("poi-music-list-c").addClass("poi-music-list-o")}}};r()}var B=(mshuffle)?"true":"false";var w=localStorage.repeat||0,z=localStorage.shuffle=B,h=true,e=true;var D=new Date(),j=z==="true"?D.getTime()%playlist.length:0,F=false,d,E,m,v;var u=function(){d.play();a("#poi-play-bar .poiplay i").html("&#xe60d;").addClass("inplay");a(".czui").removeClass("czui-c").addClass("czui-o");a("#poi-song-cover img").addClass("degs");E=setInterval(G,500);m=true};var s=function(){d.pause();a("#poi-play-bar .poiplay i").html("&#xe60c;").removeClass("inplay");a(".czui").removeClass("czui-o").addClass("czui-c");a("#poi-song-cover img").removeClass("degs");clearInterval(G);m=false};var x=function(M){var i=parseInt(M%60)<10?"0"+parseInt(M%60):parseInt(M%60),J=M/d.duration*100;var c=d.duration;var L;if(!c){L="加载中..."}else{var I=parseInt(c/60);var K=parseInt(c%60);I=I>=10?I:"0"+I;K=K>=10?K:"0"+K;L="0"+parseInt(M/60)+":"+i+"/"+I+":"+K}a("#poi-play-bar .poi-progress .poi-pace").css("width",J+"%");a("#poi-play-bar .poi-timer").html(L)};var f=function(){var c=this.seekable&&this.seekable.length?this.seekable.end(0):0;a("#poi-play-bar .poi-progress .poi-loaded").css("width",(100/(this.duration||1)*c)+"%")};var G=function(){x(d.currentTime)};a("#poi-play-bar .poi-progress .poi-sider").slider({step:0.1,slide:function(c,i){a(this).addClass("enable");x(d.duration*i.value/100);clearInterval(E)},stop:function(c,i){d.currentTime=d.duration*i.value/100;a(this).removeClass("enable");E=setInterval(G,500)}});var y=function(c){d.volume=localStorage.volume=c;a("#poi-play-bar .volume .pace").css("width",c*100+"%");a("#poi-play-bar .volume .slider a").css("left",c*100+"%")};var H=localStorage.volume||0.5;a("#poi-play-bar .volume .slider").slider({max:1,min:0,step:0.01,value:H,slide:function(c,i){y(i.value);a(this).addClass("enable");a("#poi-play-bar .mute").removeClass("enable")},stop:function(){a(this).removeClass("enable")}}).children("#poi-play-bar .pace").css("width",H*100+"%");a("#poi-play-bar .mute").click(function(){if(a(this).hasClass("enable")){y(a(this).data("volume"));a(this).removeClass("enable");a(this).addClass("fa-volume-up").removeClass("fa-volume-off")}else{a(this).data("volume",d.volume).addClass("enable");a(this).removeClass("fa-volume-up").addClass("fa-volume-off");y(0)}});var C=function(c){if(c<0){track=j=playlist.length-1}else{if(c>=playlist.length){track=j=0}else{track=c}}a("audio").remove();q(track);u()};var A=function(){var i=new Date(),c=j;j=i.getTime()%playlist.length;if(c==j){++j}C(j)};var k=function(){s();d.currentTime=0;v++;if(h==true){m=true}if(w==1){u()}else{if(z==="true"){A()}else{if(w==2){C(++j)}else{if(j<playlist.length){C(++j)}}}}};var b=function(){var c=(mautoplay)?true:false;if(e==c){u()}};var q=function(c){var J=playlist[c],I=J.list,M=(J.tags!=undefined)?" ~ "+J.tags:"",K=(J.album!=undefined)?J.album:"关于 “ "+J.search+" ” 共找到"+playlist.length+"首单曲",L=a('<audio id="mp3" src="'+I.mp3+'" type="audio/mpeg">').html("").appendTo("body");a("#poi-play-bar .poi-song-title").html("<span>"+I.title+'</span><span> - </span><span class="artist">'+I.artist+"</span>");a("#scripylrc p").html('<script>geci.build({object:"lrc_2",media:"mp3",geciUrl:"'+I.lrc+'",readType:"vls1",open:true},{oneline:false,height:"229px",width:"100%"});</script>');a(".poi-album-tiele").html(K);a(".poi-album-tags").html(M);a("#poi-song-cover").html('<img src="'+I.cover+'">');a("#poi-music-list li").removeClass("playing").eq(c).addClass("playing");d=L[0];d.volume=a("#poi-play-bar .mute").hasClass("enable")?0:1;d.addEventListener("progress",f,false);d.addEventListener("durationchange",f,false);d.addEventListener("canplay",b,false);d.addEventListener("ended",k,false)};if(a(".music-json").length>0){q(j)}a("#poi-play-bar .poiplay").on("click",function(){if(a("#poi-play-bar .poiplay i").hasClass("inplay")){s()}else{u()}});a("#poi-play-bar .rewind").on("click",function(){if(z==="true"){A()}else{C(--j)}});a("#poi-play-bar .fastforward").on("click",function(){if(z==="true"){A()}else{C(++j)}});a("#poi-music-list li").each(function(I){var c=I;a(this).on("click",function(){C(c);u()})});if(z==="true"){a("#poi-play-bar .shuffle").addClass("enable")}if(w==1){a("#poi-play-bar .repeat").addClass("once")}else{if(w==2){a("#poi-play-bar .repeat").addClass("all")}}a("#poi-play-bar .repeat").on("click",function(){if(a(this).hasClass("once")){w=localStorage.repeat=2;a(this).removeClass("once").addClass("all")}else{if(a(this).hasClass("all")){w=localStorage.repeat=0;a(this).removeClass("all")}else{w=localStorage.repeat=1;a(this).addClass("once")}}});a("#poi-play-bar .shuffle").on("click",function(){if(a(this).hasClass("enable")){z=localStorage.shuffle="false";a(this).removeClass("enable")}else{z=localStorage.shuffle="true";a(this).addClass("enable")}});a("#poi-play-bar .poi-open-list,.poi-list-close").on("click",function(){if(a("#poi-music-list").hasClass("poi-music-list-c")){a("#poi-music-list").removeClass("poi-music-list-c").addClass("poi-music-list-o")}else{a("#poi-music-list").removeClass("poi-music-list-o").addClass("poi-music-list-c")}});a("#open-poi-player").on("click",function(){if(a("#poi-music-list").hasClass("poi-music-list-o")){a("#poi-music-list").removeClass("poi-music-list-o").addClass("poi-music-list-c")}if(a("#poi-play-bar").hasClass("poi-c")){a("#poi-play-bar").removeClass("poi-c").addClass("poi-o").css({width:"100%"});a("#open-poi-player i").html("&#xe607;")}else{a("#poi-play-bar").removeClass("poi-o").addClass("poi-c").css({width:"30px"});a("#open-poi-player i").html("&#xe608;")}})})(jQuery);